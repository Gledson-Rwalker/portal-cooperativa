{% extends "layout.html" %}

{% block title %}Painel do Cooperado{% endblock %}

{% block content %}
<div class="container">
    <div class="header">
        <h2>Que bom ver você por aqui {{ nome }}!</h2>
        <a href="/logout" class="btn btn-danger">Sair</a>
    </div>
    <h3>Lista de Treinamentos da HomeAssiste</h3>
    
    <ul style="list-style: none; padding: 0;">
        {% for t in treinamentos %}
            <li style="background-color: #f9f9f9; border: 1px solid #ddd; border-radius: 5px; padding: 15px; margin-bottom: 15px;">
                <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                    
                    <!-- Conteúdo do Treinamento -->
                    <div>
                        <h4>
                            <a href="{{ url_for('detalhe_treinamento', id=t.id) }}">{{ t.titulo }}</a>
                            {% if t.status_cooperado == 'confirmada' %}
                                <span class="badge bg-success">Presença Confirmada</span>
                            {% elif t.status_cooperado == 'faltou' %}
                                <span class="badge bg-danger">Faltou</span>
                            {% endif %}
                            {% if t.is_finalizado and t.status_cooperado == 'confirmada' %}
                                <span class="badge bg-secondary">Finalizado</span>
                            {% endif %}
                        </h4>
                        <p><strong>Data:</strong> {{ t.data_formatada }}</p>
                        <p><strong>Instrutor:</strong> {{ t.instrutor }}</p>
                        <p>{{ t.descricao }}</p>
                    </div>
                    
                    <!-- Botão de Inscrição (LÓGICA ALTERADA) -->
                    <div style="margin-left: 20px; flex-shrink: 0;">
                        {% if t.inscrito %}
                            <button class="btn btn-success" disabled>Inscrito</button>
                        
                        {% elif t.ja_passou %}
                            <!-- MUDANÇA 1: Agora mostramos um botão cinza em vez de nada -->
                            <button class="btn btn-secondary" disabled>Inscrições Encerradas</button>
                        
                        {% else %}
                            <form action="{{ url_for('inscrever_treinamento', id=t.id) }}" method="post">
                                <!-- MUDANÇA 2: Mudamos o texto para forçar a atualização do Git -->
                                <button type="submit" class="btn btn-primary">Realizar Inscrição</button>
                            </form>
                        {% endif %}
                    </div>

                </div>
            </li>
        {% endfor %}
    </ul>
</div>
{% endblock %}